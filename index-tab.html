<!DOCTYPE html>
<html lang="ZH">

	<head>
		<meta charset="UTF-8">
		<title>管理首页</title>
		<!--
		<link rel="stylesheet" href="//cdn.bootcss.com/element-ui/1.1.2/theme-default/index.css" rel="external nofollow">
		<script src="//cdn.bootcss.com/vue/2.1.8/vue.min.js"></script>
		<script src="//cdn.bootcss.com/element-ui/1.1.2/index.js"></script>
		<script src="//cdn.bootcss.com/vue-resource/1.0.3/vue-resource.min.js"></script>
		-->
		<!-- 引入样式 -->
		<link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-default/index.css">
		<!-- 先引入 Vue -->
		<script src="https://unpkg.com/vue/dist/vue.js"></script>
		<!-- 引入组件库 -->
		<script src="https://unpkg.com/element-ui/lib/index.js"></script>
		<script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
	</head>

	<style>
		* {
			margin: 0;
			padding: 0;
		}
		
		.header {
			position: relative;
			box-sizing: border-box;
			width: 100%;
			height: 70px;
			font-size: 22px;
			line-height: 70px;
			color: #fff;
			background-color: #242f42;
		}
		
		.header .logo {
			float: left;
			width: 250px;
			text-align: center;
		}
		
		.sidebar {
			display: block;
			position: absolute;
			width: 250px;
			top: 70px;
			bottom: 0;
			background: #2e363f;
		}
		#sidebar {
			/*min-width: 200px;*/
			background-color: #324157;
		}
		#tabs {
			padding-left: 2px;
		}
		.content {
			padding-left: 10px;
		}
		
		
	</style>

	<body>
		<div id="app">
			<div class="wrapper">
				<!-- 头部start -->
				<div class="header">
					<div class="logo">
						后台管理系统
					</div>
				</div>
				<!-- 头部end -->
				<!-- 左边导航栏start -->
				<el-row>
					<el-col :span="4" id="sidebar">
						<el-menu theme="dark" default-active="2" class="el-menu-vertical-demo" @open="handleOpen" @close="handleClose" theme="dark">
						<el-menu-item index="1">
							<template slot="title"><i class="el-icon-message"></i>首页</template>
						</el-menu-item>
						<el-submenu index="2">
							<template slot="title"><i class="el-icon-setting"></i>系统管理</template>
							<el-menu-item index="2-1"><i class="el-icon-user"></i>用户管理</el-menu-item>
						</el-submenu>
						<el-menu-item index="3" @click="addTab(editableTabsValue2)"><i class="el-icon-setting"></i>添加tab</el-menu-item>
					</el-menu>
					</el-col>
					<el-col :span="20" id="tabs">
						<el-tabs v-model="editableTabsValue2" type="card" closable @tab-remove="removeTab">
						  <el-tab-pane
						    v-for="(item, index) in editableTabs2"
						    :key="item.name"
						    :label="item.title"
						    :name="item.name"
						  >
						  <div class="content" :id="item.id">
						  	{{item.content}}
						  </div>
						  </el-tab-pane>
					</el-col>
				</el-row>
				<!-- 内容区start -->
				<!--<div class="content">
				</div>-->
				<!-- 内容区end -->
			</div>
		</div>
	</body>
	<script>
		var app = new Vue({
			el: '#app',
			data: {
				editableTabsValue2: '2',
				editableTabs2: [{
			          title: 'Tab 1',
			          name: '1',
			          content: '',
			          url: 'page/table.html'
			        }, {
			          title: 'Tab 2',
			          name: '2',
			          content: 'Tab 2 content',
			          url: "page/table.html"
			        }],
			    tabIndex: 2
			},
			methods: {
				handleOpen: function(key, keyPath) {
					console.log(key, keyPath);
				},
				handleClose: function(key, keyPath) {
					console.log(key, keyPath);
				},
				addTab: function(targetName) {
			        var newTabName = ++this.tabIndex + '';
			        this.editableTabs2.push({
			        	id: '3',
			          title: 'New Tab',
			          name: newTabName,
			          content: ''
			        });
			        getHtml(3, 'page/table.html');
			        this.editableTabsValue2 = newTabName;
			        
			      },
			      removeTab: function(targetName) {
			        var tabs = this.editableTabs2;
			        var activeName = this.editableTabsValue2;
			        if (activeName === targetName) {
			        	for (var i = 0; i < tabs.length; i++) {
			        		tab = tabs[i];
				        	if (tab.name === targetName) {
				              var nextTab = tabs[i + 1] || tabs[i - 1];
				              if (nextTab) {
				                activeName = nextTab.name;
				              }
				            }
				        }
			        }
			        
			        this.editableTabsValue2 = activeName;
			        this.editableTabs2 = []
			        for (var i = 0; i < tabs.length; i++) {
			        	tab = tabs[i];
			        	if (tab.name !== targetName) {
			        		this.editableTabs2.push(tab);
			        	}
			        }
			      }
			}
		});
		//iframe自适应
		$(window).on('resize', function() {
			var $content = $('#sidebar');
			$content.height($(this).height());
		    $content.find('iframe').each(function() {
		    	$(this).height($content.height());
		    });
		}).resize();
		
		function getHtml(id, url) {
			$.ajax({
				url: url,
				async: true,
				success: function(data) {
					$('#'+id).html(data);
				}
			})
		}
	</script>

</html>